{% extends 'base.html' %}
{% load static %}
{% load product_filters %}

{% block title %}–ê–∫—Ü—ñ—ó - RedRabbit{% endblock %}
{% block description %}–ê–∫—Ü—ñ—ó RedRabbit –∑—ñ –∑–Ω–∏–∂–∫–∞–º–∏ –¥–æ 50%. –Ü–Ω—Ç–∏–º–Ω—ñ —Ç–æ–≤–∞—Ä–∏ –∑–∞ –≤–∏–≥—ñ–¥–Ω–∏–º–∏ —Ü—ñ–Ω–∞–º–∏ –∑ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ—é –¥–æ—Å—Ç–∞–≤–∫–æ—é.{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/catalog.css' %}">
{% endblock %}

{% block content %}
<section class="products-section section-padding">
    <div class="container">
        {% if products %}
            <!-- Filters -->
            <div class="filters-section mb-4">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p class="results-count">
                            –ó–Ω–∞–π–¥–µ–Ω–æ <strong>{{ total_products }}</strong> –∞–∫—Ü—ñ–π–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤
                        </p>
                    </div>
                    <div class="col-md-6">
                        <div class="sort-control">
                            <button type="button" class="sort-select-btn" id="sortSelectBtn">
                                <span class="sort-select-text">–°–æ—Ä—Ç—É–≤–∞—Ç–∏</span>
                                <svg class="sort-select-arrow" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M7 10L12 15L17 10H7Z" fill="currentColor"/>
                                </svg>
                            </button>
                            <div class="sort-dropdown hidden" id="sortDropdown">
                                <div class="sort-option" data-value="default">–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º</div>
                                <div class="sort-option" data-value="price_low">–ó–∞ —Ü—ñ–Ω–æ—é: –¥–µ—à–µ–≤—à—ñ —Å–ø–æ—á–∞—Ç–∫—É</div>
                                <div class="sort-option" data-value="price_high">–ó–∞ —Ü—ñ–Ω–æ—é: –¥–æ—Ä–æ–∂—á—ñ —Å–ø–æ—á–∞—Ç–∫—É</div>
                                <div class="sort-option" data-value="name">–ó–∞ –Ω–∞–∑–≤–æ—é</div>
                                <div class="sort-option" data-value="discount">–ó–∞ —Ä–æ–∑–º—ñ—Ä–æ–º –∑–Ω–∏–∂–∫–∏</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Products Grid -->
            <div class="products-grid" id="productsGrid">
                {% for product in products %}
                    {% include 'includes/product_card.html' with product=product %}
                {% endfor %}
            </div>
            
            <!-- Pagination -->
            {% if is_paginated %}
                <nav class="pagination" role="navigation" aria-label="–ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö">
                    {% if page_obj.has_previous %}
                        <a href="?page=1" class="pagination__link" aria-label="–ü–µ—Ä—à–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü®‚ü®</a>
                        <a href="?page={{ page_obj.previous_page_number }}" class="pagination__link" aria-label="–ü–æ–ø–µ—Ä–µ–¥–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü®</a>
                    {% else %}
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü®‚ü®</span>
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü®</span>
                    {% endif %}
                    
                    <span class="pagination__info" aria-live="polite">
                        –°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ page_obj.number }} –∑ {{ page_obj.paginator.num_pages }}
                    </span>
                    
                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}" class="pagination__link" aria-label="–ù–∞—Å—Ç—É–ø–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü©</a>
                        <a href="?page={{ page_obj.paginator.num_pages }}" class="pagination__link" aria-label="–û—Å—Ç–∞–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∞">‚ü©‚ü©</a>
                    {% else %}
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü©</span>
                        <span class="pagination__link pagination__link--disabled" aria-disabled="true">‚ü©‚ü©</span>
                    {% endif %}
                </nav>
            {% endif %}
        {% else %}
            <!-- Empty State -->
            <div class="empty-state text-center">
                <div class="empty-state-icon">
                    <i class="icon-sale" aria-hidden="true">üè∑Ô∏è</i>
                </div>
                <h3 class="empty-state-title">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –∞–∫—Ü—ñ–π–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤</h3>
                <p class="empty-state-text">
                    –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –Ω–∞—à–∏–º–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏, —â–æ–± –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ –≤–∏–≥—ñ–¥–Ω—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó!
                </p>
                <a href="/" class="btn btn-primary btn-lg">
                    –ù–∞ –≥–æ–ª–æ–≤–Ω—É
                </a>
            </div>
        {% endif %}
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/catalog_new.js' %}"></script>
{% endblock %}
