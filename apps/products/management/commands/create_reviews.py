from django.core.management.base import BaseCommand
from apps.products.models import Product, ProductReview, Category
import random


class Command(BaseCommand):
    help = '–°—Ç–≤–æ—Ä—é—î —Ç–µ—Å—Ç–æ–≤—ñ –≤—ñ–¥–≥—É–∫–∏ –¥–ª—è —Ç–æ–≤–∞—Ä—ñ–≤'

    def handle(self, *args, **options):
        reviews_data = [
            {
                'author_name': '–ê–Ω–æ–Ω—ñ–º',
                'rating': 5,
                'text': '–í –º–µ–Ω–µ –∫–ª–∞—Å–Ω—ñ –¥—Ä—É–∑—ñ, –ø–æ–¥–∞—Ä—É–≤–∞–ª–∏ –º–µ–Ω—ñ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ —Ü–µ–π –º–∞—Å—Ç—É—Ä–±–∞—Ç–æ—Ä —ñ —è –æ—Ñ—ñ–≥–µ–ª–∞ –≤—ñ–¥ –≤—ñ–¥—á—É—Ç—Ç—è! –¶–µ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è, –∞ –∑ –Ω–∏–º –≤—ñ–¥—á—É—Ç—Ç—è –∞–∂ –Ω—ñ–±–∏ —Å–ø—Ä–∞–≤–∂–Ω—î. –î—É–∂–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∞! –î—è–∫—É—é –∑–∞ —à–≤–∏–¥–∫—É –¥–æ—Å—Ç–∞–≤–∫—É :D',
                'category_badge': '–ü—ñ—Ö–≤–∞',
                'product_name': '–ú–∞—Å—Ç—É—Ä–±–∞—Ç–æ—Ä Kokos Bellana Vibe'
            },
            {
                'author_name': '–ì–∞—è',
                'rating': 5,
                'text': '–í–∑—è–ª–∏ —Ü–µ –∫—ñ–ª—å—Ü–µ –∑ —Ö–ª–æ–ø—Ü–µ–º, —â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ –æ–±–æ–º –∑—Ä–æ–±–∏—Ç–∏ –ø—Ä–∏—î–º–Ω–æ –≤—ñ–¥ —á–∞—Å —Å–µ–∫—Å—É. –ù–µ –∑–Ω–∞—é –∫–æ–º—É —è–∫, –∞–ª–µ –Ω–∞–º –≤—Å–µ –ø—ñ–¥—ñ–π—à–ª–æ –ø–æ —Ä–æ–∑–º—ñ—Ä—É —ñ –º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞–ª–∏—Å—è —Ö–≤–∏–ª–∏–Ω 7 –ø—Ä–æ–±–ª–µ–º –Ω–µ –±—É–ª–æ, –Ω–∞–º –Ω–∞ –∫–æ–∂–µ–Ω —Ä–∞–∑ –¥–æ–±—Ä–µ. –ó —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç—Ç—è–º –Ω–∞–¥–æ, –ø—ñ–¥—Ö–æ–¥–∏—Ç—å—Å—è –æ–¥–Ω–∞–∫.',
                'category_badge': '–ï—Ä–µ–∫—Ü—ñ–π–Ω—ñ –∫—ñ–ª—å—Ü—è',
                'product_name': '–ï—Ä–µ–∫—Ü—ñ–π–Ω–µ –∫—ñ–ª—å—Ü–µ –∑ –≤—ñ–±—Ä–∞—Ü—ñ—î—é Satisfyer Epic Duo'
            },
            {
                'author_name': '–ê–ª–µ–∫—Å',
                'rating': 4,
                'text': '–î–æ–≤–≥–∏–π —á–∞—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞–ª–∞—Å—å –ø—ñ–Ω–≥–≤—ñ–Ω—á–∏–∫–æ–º Satisfyer —ñ –º–µ–Ω–µ –≤—Å–µ –≤–ª–∞—à—Ç–æ–≤—É–≤–∞–ª–æ –±—ñ–ª—å—à–µ –Ω—ñ–∂, —Ç–∞ –∑–∞—Ö–æ—Ç—ñ–ª–æ—Å—è —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–æ—Å—å –Ω–æ–≤–µ —ñ –Ω–µ –ø—Ä–æ–≥–∞–¥–∞–ª–∞! –ó–∞ —Ü—ñ–Ω–æ—é –º–æ–∂–Ω–∞ —Å–∫–∞–∑–∞—Ç–∏ –Ω–µ —Ç–∞–∫–∞ —ñ –∑–∞ —è–∫—ñ—Å—Ç—é –æ–¥–Ω–µ —ñ —Ç–µ —Å–∞–º–µ. –ó—Ä–æ–∑—É–º—ñ–ª–æ –ø–æ–±—É–¥–æ–≤–∞ —â–æ –æ–¥–Ω–∞ –ø—Ä–∞—Ü—é—î —è–∫ —ñ–∑ —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä–æ–º –¥–ª—è –∫–ª—ñ—Ç–æ—Ä–∞. –ú–æ–∂–ª–∏–≤–æ –∑ —á–∞—Å–æ–º –±—É–¥–µ –∫—Ä–∞—â–µ.',
                'category_badge': '–í–∞–∫—É—É–º–Ω—ñ —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä–∏',
                'product_name': '–í–∞–∫—É—É–º–Ω–∏–π –≤—ñ–±—Ä–∞—Ç–æ—Ä Satisfyer Sunray'
            },
            {
                'author_name': '–û–ª–µ–Ω–∞',
                'rating': 5,
                'text': '–ß—É–¥–æ–≤–∏–π –≤—ñ–±—Ä–∞—Ç–æ—Ä! –ö–æ–º–ø–∞–∫—Ç–Ω–∏–π, –ø–æ—Ç—É–∂–Ω–∏–π, —ñ–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –ø–æ—á–∞—Ç–∫—ñ–≤—Ü—ñ–≤. –î—É–∂–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∞ –ø–æ–∫—É–ø–∫–æ—é, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å—ñ–º –ø–æ–¥—Ä—É–≥–∞–º!',
                'category_badge': '–í—ñ–±—Ä–∞—Ç–æ—Ä–∏',
                'product_name': '–í—ñ–±—Ä–∞—Ç–æ—Ä Cutiel'
            },
            {
                'author_name': '–ú–∞—Ä—ñ—è',
                'rating': 5,
                'text': '–ó–∞–º–æ–≤–∏–ª–∞ —Ü–µ–π —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä –ø—ñ—Å–ª—è –¥–æ–≤–≥–∏—Ö —Ä–æ–∑–¥—É–º—ñ–≤ —ñ –Ω–µ –ø–æ—à–∫–æ–¥—É–≤–∞–ª–∞! –Ø–∫—ñ—Å—Ç—å –Ω–∞ –≤–∏—Å–æ—Ç—ñ, —Ä–æ–±–æ—Ç–∞ –±–µ–∑—à—É–º–Ω–∞, –µ—Ñ–µ–∫—Ç –≤—Ä–∞–∂–∞—î. –î–æ—Å—Ç–∞–≤–∫–∞ —à–≤–∏–¥–∫–∞, —É–ø–∞–∫–æ–≤–∫–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–∞.',
                'category_badge': '–°—Ç–∏–º—É–ª—è—Ç–æ—Ä–∏',
                'product_name': '–ö–ª—ñ—Ç–µ—Ä–∞–ª—å–Ω–∏–π —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä'
            },
            {
                'author_name': '–î–º–∏—Ç—Ä–æ',
                'rating': 4,
                'text': '–•–æ—Ä–æ—à–∏–π —Ç–æ–≤–∞—Ä –∑–∞ —Å–≤–æ—é —Ü—ñ–Ω—É. –ú–∞—Ç–µ—Ä—ñ–∞–ª —è–∫—ñ—Å–Ω–∏–π, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑—Ä—É—á–Ω–µ. –Ñ–¥–∏–Ω–∏–π –º—ñ–Ω—É—Å - —Ç—Ä–æ—Ö–∏ –≥—É—á–Ω—ñ—à–µ –ø—Ä–∞—Ü—é—î, –Ω—ñ–∂ –æ—á—ñ–∫—É–≤–∞–≤. –í —Ü—ñ–ª–æ–º—É –∑–∞–¥–æ–≤–æ–ª–µ–Ω–∏–π.',
                'category_badge': '–ú–∞—Å—Ç—É—Ä–±–∞—Ç–æ—Ä–∏',
                'product_name': '–ú–∞—Å—Ç—É—Ä–±–∞—Ç–æ—Ä —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–π'
            },
            {
                'author_name': '–ù–∞—Ç–∞–ª—ñ—è',
                'rating': 5,
                'text': '–¶–µ –º–æ—è –ø–µ—Ä—à–∞ –ø–æ–∫—É–ø–∫–∞ —Ç–∞–∫–æ–≥–æ —Ç–∏–ø—É —ñ —è –≤ –∑–∞—Ö–≤–∞—Ç—ñ! –î—É–∂–µ –¥–µ–ª—ñ–∫–∞—Ç–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞, –≥–∞—Ä–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∞. –°–∞–º —Ç–æ–≤–∞—Ä –ø–µ—Ä–µ–≤–µ—Ä—à–∏–≤ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è, —Ç–µ–ø–µ—Ä —Ä–æ–∑—É–º—ñ—é —â–æ –≤–∏—Ç—Ä–∞—á–∞–ª–∞ —á–∞—Å –º–∞—Ä–Ω–æ —Ä–∞–Ω—ñ—à–µ üòä',
                'category_badge': '–í—ñ–±—Ä–∞—Ç–æ—Ä–∏',
                'product_name': '–í—ñ–±—Ä–∞—Ç–æ—Ä —Å–∏–ª—ñ–∫–æ–Ω–æ–≤–∏–π'
            },
            {
                'author_name': '–Ü—Ä–∏–Ω–∞',
                'rating': 5,
                'text': '–í—ñ–¥–º—ñ–Ω–Ω–∞ —è–∫—ñ—Å—Ç—å! –ë—Ä–∞–ª–∞ —è–∫ –ø–æ–¥–∞—Ä—É–Ω–æ–∫ –ø–æ–¥—Ä—É–∑—ñ, –≤–æ–Ω–∞ –≤ –∑–∞—Ö–≤–∞—Ç—ñ. –ú–∞—Ç–µ—Ä—ñ–∞–ª –ø—Ä–∏—î–º–Ω–∏–π –Ω–∞ –¥–æ—Ç–∏–∫, –≤—Å–µ –ø—Ä–∞—Ü—é—î —è–∫ —Ç—Ä–µ–±–∞. –î—è–∫—É—é –º–∞–≥–∞–∑–∏–Ω—É –∑–∞ —à–≤–∏–¥–∫—É –æ–±—Ä–æ–±–∫—É –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è!',
                'category_badge': '–°—Ç–∏–º—É–ª—è—Ç–æ—Ä–∏',
                'product_name': '–¢–æ—á–∫–æ–≤–∏–π —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä'
            }
        ]

        active_products = list(Product.objects.filter(is_active=True))
        
        if not active_products:
            self.stdout.write(self.style.WARNING('–ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ç–æ–≤–∞—Ä—ñ–≤. –°—Ç–≤–æ—Ä—é—é —Ç–æ–≤–∞—Ä–∏-–∑–∞–≥–ª—É—à–∫–∏...'))
            
            category = Category.objects.filter(is_active=True).first()
            if not category:
                category = Category.objects.create(
                    name='–î–ª—è –Ω–µ—ó',
                    slug='for-her',
                    is_active=True,
                    sort_order=1
                )
            
            for review_data in reviews_data:
                product = Product.objects.create(
                    name=review_data['product_name'],
                    slug=f"product-{random.randint(1000, 9999)}",
                    primary_category=category,
                    retail_price=999,
                    is_active=True,
                    description=f"–¢–æ–≤–∞—Ä –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó {review_data['category_badge']}"
                )
                active_products.append(product)
            
            self.stdout.write(self.style.SUCCESS(f'‚úì –°—Ç–≤–æ—Ä–µ–Ω–æ {len(active_products)} —Ç–æ–≤–∞—Ä—ñ–≤'))

        ProductReview.objects.filter(is_approved=True).delete()
        created_count = 0

        for review_data in reviews_data:
            product = Product.objects.filter(
                name__icontains=review_data['product_name'].split()[0],
                is_active=True
            ).first()
            
            if not product:
                product = random.choice(active_products)
            
            ProductReview.objects.create(
                product=product,
                author_name=review_data['author_name'],
                rating=review_data['rating'],
                text=review_data['text'],
                category_badge=review_data['category_badge'],
                is_approved=True
            )
            created_count += 1

        self.stdout.write(
            self.style.SUCCESS(f'‚úì –°—Ç–≤–æ—Ä–µ–Ω–æ {created_count} –≤—ñ–¥–≥—É–∫—ñ–≤')
        )

